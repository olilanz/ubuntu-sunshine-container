#!/usr/bin/execlineb -P
with-contenv
backtick -E DISPLAY { import -u DISPLAY }
foreground { s6-echo "sunshine: waiting for X at ${DISPLAY} ..." }
if { waitfile -t 300 /tmp/.X11-unix/X0 }
foreground { s6-echo "sunshine: X socket found, proceeding..." }
else
foreground { s6-echo "sunshine: X socket not found, exiting..." }
exit 1
endif
foreground { s6-echo "sunshine: waiting for PulseAudio to initialize..." }
s6-sleep 2
foreground { s6-echo "sunshine: PulseAudio initialized, proceeding..." }
s6-echo "sunshine: starting Sunshine service..."
exec -c /usr/bin/sunshine --config-dir /config/sunshine
